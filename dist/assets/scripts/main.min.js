var swiper=new Swiper(".swiper-container",{pagination:".swiper-pagination",paginationClickable:!0,effect:"fade",speed:800}),black={r:0,g:0,b:0},blue={r:0,g:116,b:190},darkblue={r:0,g:0,b:139},red={r:229,g:0,b:30},green={r:103,g:228,b:126},darkgreen={r:0,g:100,b:0},olive={r:85,g:107,b:47},yellow={r:234,g:245,b:67},darkyellow={r:245,g:232,b:85},orange={r:255,g:183,b:76},pink={r:239,g:117,b:188},purple={r:167,g:107,b:223},brown={r:132,g:66,b:19},gray={r:105,g:105,b:105},currentColor=null,currentThreshold=90,colorToThreshold=function(src,dst,w,h,th,color){for(var i=0;i<h;i++)for(var j=0;j<w;j++){var p=4*(i*w+j);.299*src[p]+.587*src[p+1]+.114*src[p+2]<th?(dst[p]=color.r,dst[p+1]=color.g,dst[p+2]=color.b):(dst[p]=255,dst[p+1]=255,dst[p+2]=255),dst[p+3]=src[p+3]}},createThresholdImg=function(im,cvs_origin,cvs,reader){(im=new Image).onload=function(){var w=im.width,h=im.height,ctx_origin=cvs_origin.getContext("2d");cvs_origin.width=w,cvs_origin.height=h,ctx_origin.drawImage(im,0,0);var ctx=cvs.getContext("2d");cvs.width=w,cvs.height=h,ctx.drawImage(im,0,0);var im1Data=ctx.getImageData(0,0,w,h),im2Data=ctx.createImageData(w,h),im1=im1Data.data,im2=im2Data.data;colorToThreshold(im1,im2,w,h,currentThreshold,currentColor),ctx.putImageData(im2Data,0,0),document.querySelector(".mainContent_images").innerHTML='<div class="flex show"><div><img class="mainContent_images_origin mobile_hidden" src="'+cvs_origin.toDataURL()+'" alt=""></div><div><img class="mainContent_images_binarized" src="'+cvs.toDataURL()+'" alt=""></div></div>',document.querySelector(".downloadLink").href=cvs.toDataURL(),document.querySelector(".mainContent_images").style.display="flex",document.querySelector(".mainContent_images").style["justify-content"]="center"},im.src=reader.result},changeThresholdImg=function(im,cvs_origin,cvs,reader){(im=new Image).onload=function(){var w=im.width,h=im.height,ctx_origin=cvs_origin.getContext("2d");cvs_origin.width=w,cvs_origin.height=h,ctx_origin.drawImage(im,0,0);var ctx=cvs.getContext("2d");cvs.width=w,cvs.height=h,ctx.drawImage(im,0,0);var im1Data=ctx.getImageData(0,0,w,h),im2Data=ctx.createImageData(w,h),im1=im1Data.data,im2=im2Data.data;colorToThreshold(im1,im2,w,h,currentThreshold,currentColor),ctx.putImageData(im2Data,0,0),document.querySelector(".mainContent_images_binarized").src=cvs.toDataURL(),document.querySelector(".downloadLink").href=cvs.toDataURL()},im.src=reader.result},im=null,cvs=null,cvs_origin=null,file=null,reader=null;window.addEventListener("DOMContentLoaded",function(){var ofd=document.getElementById("selectfile");document.querySelector(".blue").addEventListener("click",function(){currentColor=blue,createThresholdImg(im,cvs_origin,cvs,reader)},!1),document.querySelector(".darkblue").addEventListener("click",function(){currentColor=darkblue,createThresholdImg(im,cvs_origin,cvs,reader)},!1),document.querySelector(".red").addEventListener("click",function(){currentColor=red,createThresholdImg(im,cvs_origin,cvs,reader)},!1),document.querySelector(".green").addEventListener("click",function(){currentColor=green,createThresholdImg(im,cvs_origin,cvs,reader)},!1),document.querySelector(".darkgreen").addEventListener("click",function(){currentColor=darkgreen,createThresholdImg(im,cvs_origin,cvs,reader)},!1),document.querySelector(".olive").addEventListener("click",function(){currentColor=olive,createThresholdImg(im,cvs_origin,cvs,reader)},!1),document.querySelector(".yellow").addEventListener("click",function(){currentColor=yellow,createThresholdImg(im,cvs_origin,cvs,reader)},!1),document.querySelector(".darkyellow").addEventListener("click",function(){currentColor=darkyellow,createThresholdImg(im,cvs_origin,cvs,reader)},!1),document.querySelector(".orange").addEventListener("click",function(){currentColor=orange,createThresholdImg(im,cvs_origin,cvs,reader)},!1),document.querySelector(".pink").addEventListener("click",function(){currentColor=pink,createThresholdImg(im,cvs_origin,cvs,reader)},!1),document.querySelector(".purple").addEventListener("click",function(){currentColor=purple,createThresholdImg(im,cvs_origin,cvs,reader)},!1),document.querySelector(".black").addEventListener("click",function(){currentColor=black,createThresholdImg(im,cvs_origin,cvs,reader)},!1),document.querySelector(".brown").addEventListener("click",function(){currentColor=brown,createThresholdImg(im,cvs_origin,cvs,reader)},!1),document.querySelector(".gray").addEventListener("click",function(){currentColor=gray,createThresholdImg(im,cvs_origin,cvs,reader)},!1);var slider=document.querySelector("[type=range]");slider.addEventListener("input",function(){currentThreshold=slider.value,changeThresholdImg(im,cvs_origin,cvs,reader)},!1),slider.addEventListener("change",function(){currentThreshold=slider.value,changeThresholdImg(im,cvs_origin,cvs,reader)},!1),ofd.addEventListener("change",function(evt){im=null,cvs_origin=document.createElement("canvas"),cvs=document.createElement("canvas"),file=evt.target.files,(reader=new FileReader).readAsDataURL(file[0]),reader.onload=function(){document.querySelector(".mainContent_controlPannel").classList.add("show"),currentColor=pink,currentThreshold=60,createThresholdImg(im,cvs_origin,cvs,reader)}},!1)});